\section{Dokumentace souboru irc2.c}
\label{irc2_8c}\index{irc2.c@{irc2.c}}
{\ttfamily \#include $<$avr/io.h$>$}\par
{\ttfamily \#include $<$avr/interrupt.h$>$}\par
{\ttfamily \#include $<$avr/pgmspace.h$>$}\par
{\ttfamily \#include $<$stdio.h$>$}\par
{\ttfamily \#include $<$stdint.h$>$}\par
{\ttfamily \#include \char`\"{}usart.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}irc2.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}eeprom.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}error.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}lcd.h\char`\"{}}\par
\subsection*{Definice maker}
\begin{DoxyCompactItemize}
\item 
\#define {\bf A\_\-PORT}~PORTB
\item 
\#define {\bf A\_\-PIN}~PINB
\item 
\#define {\bf A\_\-BIT}~3
\item 
\#define {\bf B\_\-PORT}~PORTB
\item 
\#define {\bf B\_\-PIN}~PINB
\item 
\#define {\bf B\_\-BIT}~4
\item 
\#define {\bf SP\_\-PORT}~PORTD
\item 
\#define {\bf SP\_\-PIN}~PINB
\item 
\#define {\bf SP\_\-BIT}~5
\end{DoxyCompactItemize}
\subsection*{Funkce}
\begin{DoxyCompactItemize}
\item 
int32\_\-t {\bf get\_\-irc2\_\-set\_\-on\_\-value} ()
\begin{DoxyCompactList}\small\item\em Výstup je v setinách milimetru. Je třeba jej vydělit 1000 aby byl v cm. \item\end{DoxyCompactList}\item 
void {\bf set\_\-irc2\_\-counter} (int32\_\-t a)
\item 
int32\_\-t {\bf get\_\-irc2\_\-counter} (void)
\item 
void {\bf set\_\-irc2\_\-k} (uint16\_\-t a)
\item 
void {\bf set\_\-irc2\_\-k\_\-mm} (uint16\_\-t i)
\item 
uint16\_\-t {\bf irc2\_\-get\_\-k} (void)
\item 
void {\bf set\_\-irc2\_\-set\_\-on\_\-value\_\-mm} (int32\_\-t q)
\item 
void {\bf set\_\-irc2\_\-set\_\-on\_\-value} (int32\_\-t a)
\item 
void {\bf irc2\_\-init} (void)
\item 
void {\bf irc2\_\-watch} (void)
\item 
uint16\_\-t {\bf irc2\_\-get\_\-l} (void)
\end{DoxyCompactItemize}
\subsection*{Proměnné}
\begin{DoxyCompactItemize}
\item 
static unsigned char {\bf prev\_\-state}
\begin{DoxyCompactList}\small\item\em \} \item\end{DoxyCompactList}\item 
static int32\_\-t {\bf irc\_\-counter} = 0
\begin{DoxyCompactList}\small\item\em počítadlo kroků \item\end{DoxyCompactList}\item 
static int32\_\-t {\bf irc\_\-set\_\-on\_\-value} = 100
\begin{DoxyCompactList}\small\item\em Hodnota pro nastavení při přejezdu přes nastavovací snímač. \item\end{DoxyCompactList}\item 
static unsigned char {\bf last\_\-oper\_\-with\_\-irc\_\-counter} = 0
\item 
static uint16\_\-t {\bf irc\_\-k} = 100
\end{DoxyCompactItemize}


\subsection{Dokumentace k definicím maker}
\index{irc2.c@{irc2.c}!A\_\-BIT@{A\_\-BIT}}
\index{A\_\-BIT@{A\_\-BIT}!irc2.c@{irc2.c}}
\subsubsection[{A\_\-BIT}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\_\-BIT~3}\label{irc2_8c_ae59e66b2ffaf088f18f894088f53205b}
\index{irc2.c@{irc2.c}!A\_\-PIN@{A\_\-PIN}}
\index{A\_\-PIN@{A\_\-PIN}!irc2.c@{irc2.c}}
\subsubsection[{A\_\-PIN}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\_\-PIN~PINB}\label{irc2_8c_a955d6d7f3f806537072f993708e00f65}
\index{irc2.c@{irc2.c}!A\_\-PORT@{A\_\-PORT}}
\index{A\_\-PORT@{A\_\-PORT}!irc2.c@{irc2.c}}
\subsubsection[{A\_\-PORT}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\_\-PORT~PORTB}\label{irc2_8c_ac9baf768fde81ade6f9ccde1d20d5a32}
Definice pinů pro vstup A, B a setpoint \{ \index{irc2.c@{irc2.c}!B\_\-BIT@{B\_\-BIT}}
\index{B\_\-BIT@{B\_\-BIT}!irc2.c@{irc2.c}}
\subsubsection[{B\_\-BIT}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\_\-BIT~4}\label{irc2_8c_a07e5089fd757ebcad8929674eecf6c80}
\index{irc2.c@{irc2.c}!B\_\-PIN@{B\_\-PIN}}
\index{B\_\-PIN@{B\_\-PIN}!irc2.c@{irc2.c}}
\subsubsection[{B\_\-PIN}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\_\-PIN~PINB}\label{irc2_8c_a45bd909a8fb5205b60cd8c8d6760db7a}
\index{irc2.c@{irc2.c}!B\_\-PORT@{B\_\-PORT}}
\index{B\_\-PORT@{B\_\-PORT}!irc2.c@{irc2.c}}
\subsubsection[{B\_\-PORT}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\_\-PORT~PORTB}\label{irc2_8c_a04e1bd382a6de1a30d813bb79f30fb02}
\index{irc2.c@{irc2.c}!SP\_\-BIT@{SP\_\-BIT}}
\index{SP\_\-BIT@{SP\_\-BIT}!irc2.c@{irc2.c}}
\subsubsection[{SP\_\-BIT}]{\setlength{\rightskip}{0pt plus 5cm}\#define SP\_\-BIT~5}\label{irc2_8c_a2401c1030e02b8da7b3586e2f788d792}
\index{irc2.c@{irc2.c}!SP\_\-PIN@{SP\_\-PIN}}
\index{SP\_\-PIN@{SP\_\-PIN}!irc2.c@{irc2.c}}
\subsubsection[{SP\_\-PIN}]{\setlength{\rightskip}{0pt plus 5cm}\#define SP\_\-PIN~PINB}\label{irc2_8c_acb5711bd7b75243461976cb414b29c44}
\index{irc2.c@{irc2.c}!SP\_\-PORT@{SP\_\-PORT}}
\index{SP\_\-PORT@{SP\_\-PORT}!irc2.c@{irc2.c}}
\subsubsection[{SP\_\-PORT}]{\setlength{\rightskip}{0pt plus 5cm}\#define SP\_\-PORT~PORTD}\label{irc2_8c_a07104d9db9a8c1da66b457a777088113}


\subsection{Dokumentace funkcí}
\index{irc2.c@{irc2.c}!get\_\-irc2\_\-counter@{get\_\-irc2\_\-counter}}
\index{get\_\-irc2\_\-counter@{get\_\-irc2\_\-counter}!irc2.c@{irc2.c}}
\subsubsection[{get\_\-irc2\_\-counter}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t get\_\-irc2\_\-counter (void)}\label{irc2_8c_a12bd5631a35458163e675a4738df8ac7}
\index{irc2.c@{irc2.c}!get\_\-irc2\_\-set\_\-on\_\-value@{get\_\-irc2\_\-set\_\-on\_\-value}}
\index{get\_\-irc2\_\-set\_\-on\_\-value@{get\_\-irc2\_\-set\_\-on\_\-value}!irc2.c@{irc2.c}}
\subsubsection[{get\_\-irc2\_\-set\_\-on\_\-value}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t get\_\-irc2\_\-set\_\-on\_\-value (void)}\label{irc2_8c_aeae106a4dc2959c7a8e13ccdb9a43d95}


Výstup je v setinách milimetru. Je třeba jej vydělit 1000 aby byl v cm. \index{irc2.c@{irc2.c}!irc2\_\-get\_\-k@{irc2\_\-get\_\-k}}
\index{irc2\_\-get\_\-k@{irc2\_\-get\_\-k}!irc2.c@{irc2.c}}
\subsubsection[{irc2\_\-get\_\-k}]{\setlength{\rightskip}{0pt plus 5cm}uint16\_\-t irc2\_\-get\_\-k (void)}\label{irc2_8c_a8a8e13b00bbf1550a74a1aa2fd637470}
\index{irc2.c@{irc2.c}!irc2\_\-get\_\-l@{irc2\_\-get\_\-l}}
\index{irc2\_\-get\_\-l@{irc2\_\-get\_\-l}!irc2.c@{irc2.c}}
\subsubsection[{irc2\_\-get\_\-l}]{\setlength{\rightskip}{0pt plus 5cm}uint16\_\-t irc2\_\-get\_\-l (void)}\label{irc2_8c_a9a7f216fac24f1bb5342700bdfcc865a}
\index{irc2.c@{irc2.c}!irc2\_\-init@{irc2\_\-init}}
\index{irc2\_\-init@{irc2\_\-init}!irc2.c@{irc2.c}}
\subsubsection[{irc2\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}void irc2\_\-init (void)}\label{irc2_8c_a82d08977a4cf71b6cad65346a58ec837}
Inicializace IRC. \index{irc2.c@{irc2.c}!irc2\_\-watch@{irc2\_\-watch}}
\index{irc2\_\-watch@{irc2\_\-watch}!irc2.c@{irc2.c}}
\subsubsection[{irc2\_\-watch}]{\setlength{\rightskip}{0pt plus 5cm}void irc2\_\-watch (void)}\label{irc2_8c_ac24ca6f0906ccdfb6ffe65d2a28abaf7}
V teto funkci je reseno sledovani vstupu irc a jeho nastaveni. Vzdy kdyz je funkce zavolana, je zkontrolovano, zda nedoslo okd minuleho zavolani ke zmene na vstupech irc. Pokud ano, jsou provedeny prislusne korky -\/ zvyseni nebo snizeni citace irc a pripadne odeslani namerene hodnoty. Namerena hodnota je dana jako hodnota irc cidla krat konstanta (obvykle mensi nez jedna). \index{irc2.c@{irc2.c}!set\_\-irc2\_\-counter@{set\_\-irc2\_\-counter}}
\index{set\_\-irc2\_\-counter@{set\_\-irc2\_\-counter}!irc2.c@{irc2.c}}
\subsubsection[{set\_\-irc2\_\-counter}]{\setlength{\rightskip}{0pt plus 5cm}void set\_\-irc2\_\-counter (int32\_\-t {\em a})}\label{irc2_8c_abe8163b2ba712f1a83891ce75e903037}
\index{irc2.c@{irc2.c}!set\_\-irc2\_\-k@{set\_\-irc2\_\-k}}
\index{set\_\-irc2\_\-k@{set\_\-irc2\_\-k}!irc2.c@{irc2.c}}
\subsubsection[{set\_\-irc2\_\-k}]{\setlength{\rightskip}{0pt plus 5cm}void set\_\-irc2\_\-k (uint16\_\-t {\em a})}\label{irc2_8c_aca073e77760684114a3d1f46adef8efc}
\index{irc2.c@{irc2.c}!set\_\-irc2\_\-k\_\-mm@{set\_\-irc2\_\-k\_\-mm}}
\index{set\_\-irc2\_\-k\_\-mm@{set\_\-irc2\_\-k\_\-mm}!irc2.c@{irc2.c}}
\subsubsection[{set\_\-irc2\_\-k\_\-mm}]{\setlength{\rightskip}{0pt plus 5cm}void set\_\-irc2\_\-k\_\-mm (uint16\_\-t {\em i})}\label{irc2_8c_a20d90a499e8980683f9c54225e397a9f}
Funkce vypočte a nastaví přenásobovací konstantu irc Vstupem je číslo, které odpodvídá kolik milimetrů je na jednu otáčku. \index{irc2.c@{irc2.c}!set\_\-irc2\_\-set\_\-on\_\-value@{set\_\-irc2\_\-set\_\-on\_\-value}}
\index{set\_\-irc2\_\-set\_\-on\_\-value@{set\_\-irc2\_\-set\_\-on\_\-value}!irc2.c@{irc2.c}}
\subsubsection[{set\_\-irc2\_\-set\_\-on\_\-value}]{\setlength{\rightskip}{0pt plus 5cm}void set\_\-irc2\_\-set\_\-on\_\-value (int32\_\-t {\em a})}\label{irc2_8c_a41a0bca6c07f8b1245a4b59a8209fce9}
\index{irc2.c@{irc2.c}!set\_\-irc2\_\-set\_\-on\_\-value\_\-mm@{set\_\-irc2\_\-set\_\-on\_\-value\_\-mm}}
\index{set\_\-irc2\_\-set\_\-on\_\-value\_\-mm@{set\_\-irc2\_\-set\_\-on\_\-value\_\-mm}!irc2.c@{irc2.c}}
\subsubsection[{set\_\-irc2\_\-set\_\-on\_\-value\_\-mm}]{\setlength{\rightskip}{0pt plus 5cm}void set\_\-irc2\_\-set\_\-on\_\-value\_\-mm (int32\_\-t {\em q})}\label{irc2_8c_a9d85c077b39fc2e091d54dcbfff72608}
Nastavení hodnoty. Vstupem je vzdálenost nastavovacíhoo bodu od počátku v centimetrech vynásobená deseti. tj 65 cm je 650 

\subsection{Dokumentace proměnných}
\index{irc2.c@{irc2.c}!irc\_\-counter@{irc\_\-counter}}
\index{irc\_\-counter@{irc\_\-counter}!irc2.c@{irc2.c}}
\subsubsection[{irc\_\-counter}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t {\bf irc\_\-counter} = 0\hspace{0.3cm}{\ttfamily  [static]}}\label{irc2_8c_a2420ea5087a6c97e0f0e60946bb6bed2}


počítadlo kroků \index{irc2.c@{irc2.c}!irc\_\-k@{irc\_\-k}}
\index{irc\_\-k@{irc\_\-k}!irc2.c@{irc2.c}}
\subsubsection[{irc\_\-k}]{\setlength{\rightskip}{0pt plus 5cm}uint16\_\-t {\bf irc\_\-k} = 100\hspace{0.3cm}{\ttfamily  [static]}}\label{irc2_8c_a2823da0ac1f311c8b12078b236bbeb67}
irc\_\-k konstanta, kterou se násobí irc\_\-counter před odesláním. Tim se převádí hodnota na použitelné jednotky. \index{irc2.c@{irc2.c}!irc\_\-set\_\-on\_\-value@{irc\_\-set\_\-on\_\-value}}
\index{irc\_\-set\_\-on\_\-value@{irc\_\-set\_\-on\_\-value}!irc2.c@{irc2.c}}
\subsubsection[{irc\_\-set\_\-on\_\-value}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t {\bf irc\_\-set\_\-on\_\-value} = 100\hspace{0.3cm}{\ttfamily  [static]}}\label{irc2_8c_ace11bc81992ca3824a4fb55ff1d5b47b}


Hodnota pro nastavení při přejezdu přes nastavovací snímač. \index{irc2.c@{irc2.c}!last\_\-oper\_\-with\_\-irc\_\-counter@{last\_\-oper\_\-with\_\-irc\_\-counter}}
\index{last\_\-oper\_\-with\_\-irc\_\-counter@{last\_\-oper\_\-with\_\-irc\_\-counter}!irc2.c@{irc2.c}}
\subsubsection[{last\_\-oper\_\-with\_\-irc\_\-counter}]{\setlength{\rightskip}{0pt plus 5cm}unsigned char {\bf last\_\-oper\_\-with\_\-irc\_\-counter} = 0\hspace{0.3cm}{\ttfamily  [static]}}\label{irc2_8c_a40b68af2e4f96a1cfd2785b6d3b8aa9c}
Poslední operace provedena s irc počítadlem 0 -\/ bylo naposled odečítáno, 1 -\/ přičítáno vlastně to vyjadřuje směr pohybu \index{irc2.c@{irc2.c}!prev\_\-state@{prev\_\-state}}
\index{prev\_\-state@{prev\_\-state}!irc2.c@{irc2.c}}
\subsubsection[{prev\_\-state}]{\setlength{\rightskip}{0pt plus 5cm}unsigned char {\bf prev\_\-state}\hspace{0.3cm}{\ttfamily  [static]}}\label{irc2_8c_ad24a7209740a83b880691380fbe8e0e9}


\} Hodnota kanálů A a B při minulém volání funkce irc\_\-watch(). 